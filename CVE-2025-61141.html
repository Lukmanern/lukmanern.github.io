<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Lukman - Blog & Advisory</title>
    <link rel="stylesheet" href="blog.css" />
  </head>
  <body>
    <div class="container">
      <header>
        <h1>Lukman - Blog & Advisory</h1>
        <nav>
          <a target="_blank" href="https://www.linkedin.com/in/lukman-ernandi/"
            ><svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="currentColor"
              class="icon icon-tabler icons-tabler-filled icon-tabler-brand-linkedin"
            >
              <path stroke="none" d="M0 0h24v24H0z" fill="none" />
              <path
                d="M17 2a5 5 0 0 1 5 5v10a5 5 0 0 1 -5 5h-10a5 5 0 0 1 -5 -5v-10a5 5 0 0 1 5 -5zm-9 8a1 1 0 0 0 -1 1v5a1 1 0 0 0 2 0v-5a1 1 0 0 0 -1 -1m6 0a3 3 0 0 0 -1.168 .236l-.125 .057a1 1 0 0 0 -1.707 .707v5a1 1 0 0 0 2 0v-3a1 1 0 0 1 2 0v3a1 1 0 0 0 2 0v-3a3 3 0 0 0 -3 -3m-6 -3a1 1 0 0 0 -.993 .883l-.007 .127a1 1 0 0 0 1.993 .117l.007 -.127a1 1 0 0 0 -1 -1"
              /></svg
            >/LinkedIn</a
          >
          <a target="_blank" href="https://github.com/Lukmanern/">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="currentColor"
              class="icon icon-tabler icons-tabler-filled icon-tabler-brand-github"
            >
              <path stroke="none" d="M0 0h24v24H0z" fill="none" />
              <path
                d="M5.315 2.1c.791 -.113 1.9 .145 3.333 .966l.272 .161l.16 .1l.397 -.083a13.3 13.3 0 0 1 4.59 -.08l.456 .08l.396 .083l.161 -.1c1.385 -.84 2.487 -1.17 3.322 -1.148l.164 .008l.147 .017l.076 .014l.05 .011l.144 .047a1 1 0 0 1 .53 .514a5.2 5.2 0 0 1 .397 2.91l-.047 .267l-.046 .196l.123 .163c.574 .795 .93 1.728 1.03 2.707l.023 .295l.007 .272c0 3.855 -1.659 5.883 -4.644 6.68l-.245 .061l-.132 .029l.014 .161l.008 .157l.004 .365l-.002 .213l-.003 3.834a1 1 0 0 1 -.883 .993l-.117 .007h-6a1 1 0 0 1 -.993 -.883l-.007 -.117v-.734c-1.818 .26 -3.03 -.424 -4.11 -1.878l-.535 -.766c-.28 -.396 -.455 -.579 -.589 -.644l-.048 -.019a1 1 0 0 1 .564 -1.918c.642 .188 1.074 .568 1.57 1.239l.538 .769c.76 1.079 1.36 1.459 2.609 1.191l.001 -.678l-.018 -.168a5.03 5.03 0 0 1 -.021 -.824l.017 -.185l.019 -.12l-.108 -.024c-2.976 -.71 -4.703 -2.573 -4.875 -6.139l-.01 -.31l-.004 -.292a5.6 5.6 0 0 1 .908 -3.051l.152 -.222l.122 -.163l-.045 -.196a5.2 5.2 0 0 1 .145 -2.642l.1 -.282l.106 -.253a1 1 0 0 1 .529 -.514l.144 -.047l.154 -.03z"
              /></svg
            >/Github</a
          >
        </nav>
      </header>

      <!-- Artikel POC CVE -->
      <article>
        <h2>CVE-2025-61141 OS Command Injection in SQLS v0.2.28</h2>
        <div class="article-meta">
          SQLS at Github =>
          <a href="https://github.com/sqls-server/sqls"
            >github.com/sqls-server/sqls</a
          >
        </div>
        <div class="article-content">
          <h3><i>#</i> Description</h3>
          <p>
            OS command injection vulnerability found in SQLS version 0.2.28 in
            the openEditor() function in main.go. The openEditor() function
            constructs and executes the contents of the EDITOR environment
            variable by invoking a system shell (sh -c on POSIX or cmd /c on
            Windows) rather than executing a program with discrete arguments. An
            authenticated user (or attacker) can change the EDITOR value may
            cause arbitrary commands to be executed with the same privileges as
            the SQLS process (i.e., the privileges of the user or service
            account that runs the SQLS binary).
          </p>

          <h3><i>#</i> Proof of Concept</h3>
          <p>
            Youtube Link:
            <a
              target="_blank"
              href="https://www.youtube.com/watch?v=ODGAOuLe-A4"
              >https://www.youtube.com/watch?v=ODGAOuLe-A4</a
            >
          </p>
          <div class="video-container">
            <iframe
              src="https://www.youtube.com/watch?v=ODGAOuLe-A4"
              title="CVE-2025-61141 POC Video"
              frameborder="0"
              allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
              referrerpolicy="strict-origin-when-cross-origin"
              allowfullscreen
            ></iframe>
          </div>

          <div class="media-container">
            <!-- Placeholder untuk gambar POC -->
            <img
              src="./assets/sqls-main-go-openEditor.png"
              alt="POC Screenshot"
            />
          </div>

          <p>
            The openEditor() function uses exec.Command("sh", "-c", ...) without
            sanitized input, which spawns a POSIX shell to parse and execute the
            entire command string (including pipes, redirects, globbing, etc.),
            enabling OS command injection.
          </p>

          <pre class="code-block">
func openEditor(program string, args ...string) error {
  cmdargs := strings.Join(args, " ")
  command := program + " " + cmdargs

  var cmd *exec.Cmd
  if runtime.GOOS == "windows" {
    cmd = exec.Command("cmd", "/c", command)
  } else {
    cmd = exec.Command("sh", "-c", command)
  }
  cmd.Stdin = os.Stdin
  cmd.Stdout = os.Stdout
  cmd.Stderr = os.Stderr
  return cmd.Run()
}
          </pre>
          <div class="code-block">
            exec.Command("cmd", "/c", command)
            <br />
            exec.Command("sh", "-c", command)
          </div>

          <h3><i>#</i> Impact</h3>
          <p>This issue lead to a arbitrary command execution.</p>

          <h3><i>#</i> CVSS4.0 and CWE</h3>

          <div class="code-block">
            <a
              target="_blank"
              href="https://www.first.org/cvss/calculator/4-0#CVSS:4.0/AV:L/AC:L/AT:N/PR:H/UI:A/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N"
              >CVSS4.0 Calc</a
            >
            <br />
            7.0 / High
            CVSS:4.0/AV:L/AC:L/AT:N/PR:H/UI:A/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N
          </div>
          <div class="code-block">
            <a
              target="_blank"
              href="https://cwe.mitre.org/data/definitions/20.html"
              >cwe.mitre.org/data/definitions/20.html</a
            >
            <br />
            CWE-20: Improper Input Validation
          </div>
          <div class="code-block">
            <a
              target="_blank"
              href="https://cwe.mitre.org/data/definitions/78.html"
              >cwe.mitre.org/data/definitions/78.html</a
            >
            <br />
            CWE-78: Improper Neutralization of Special Elements used in an OS
            Command ('OS Command Injection')
          </div>

          <h3><i>#</i> Timeline</h3>
          <ul>
            <li>6 Sept 2025 >> Submit CVE at https://cveform.mitre.org/</li>
            <li>25 Oct 2025 >> Got email for reserved CVE-2025-61141</li>
            <li>29 Oct 2025 >> This POC</li>
          </ul>

          <a href="./index.html" class="back-link">&larr; Back to Home</a>
        </div>
      </article>

      <footer>Â© 2025 Lukman E, Blog & Advisory</footer>
    </div>
  </body>
</html>
